{% extends "base.html" %}

{% block title %}Config - GMO Bot Manager{% endblock %}

{% block content %}
<h1>Bot Configuration</h1>

<div class="card">
    <form method="POST" action="{{ url_for('config.config_save') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
            <label for="symbol">Symbol</label>
            <input type="text" id="symbol" name="symbol" value="{{ config.get('symbol', 'BTC_JPY') }}" required pattern="[A-Z]+_[A-Z]+" title="Format: XXX_YYY (e.g., BTC_JPY)">
            <small>Trading pair (e.g., BTC_JPY, ETH_JPY)</small>
        </div>

        <div class="form-group">
            <label for="trade_amount">Trade Amount</label>
            <input type="number" id="trade_amount" name="trade_amount" value="{{ config.get('trade_amount', 0.001) }}" step="0.0001" min="0" required>
            <small>Amount per trade</small>
        </div>

        <div class="form-group">
            <label for="max_position">Max Position</label>
            <input type="number" id="max_position" name="max_position" value="{{ config.get('max_position', 0.01) }}" step="0.0001" min="0">
            <small>Maximum position size</small>
        </div>

        <div class="form-group">
            <label for="spread_threshold">Spread Threshold</label>
            <input type="number" id="spread_threshold" name="spread_threshold" value="{{ config.get('spread_threshold', 100) }}" step="1" min="0">
            <small>Minimum spread to trade (JPY)</small>
        </div>

        {% for key, value in config.items() %}
            {% if key not in ['symbol', 'trade_amount', 'max_position', 'spread_threshold'] %}
            <div class="form-group">
                <label for="{{ key }}">{{ key }}</label>
                <input type="text" id="{{ key }}" name="{{ key }}" value="{{ value }}">
            </div>
            {% endif %}
        {% endfor %}

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save Configuration</button>
            <a href="{{ url_for('dashboard.index') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<div class="card">
    <h2>Notes</h2>
    <ul>
        <li>Configuration changes require bot restart to take effect</li>
        <li>A backup is created automatically before saving</li>
        <li>Symbol format: XXX_YYY (e.g., BTC_JPY)</li>
    </ul>
</div>
{% endblock %}
